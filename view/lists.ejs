<% layout('layouts/boilerplate') %>

<h1 class="text-center mb-4">All Listings</h1>

<div class="container mb-4">
    <div class="row align-items-center">
        <div class="col-md-10 d-flex flex-wrap gap-2">
            <a href="/listings?sort=trending" class="btn btn-outline-primary btn-sm px-3 py-1 fw-semibold shadow-sm border-0">🔥 Trending</a>
            <a href="/listings?category=rooms" class="btn btn-outline-success btn-sm px-3 py-1 fw-semibold shadow-sm border-0">🛏️ Rooms</a>
            <a href="/listings?category=iconic-cities" class="btn btn-outline-dark btn-sm px-3 py-1 fw-semibold shadow-sm border-0">🏙️ Iconic Cities</a>
            <a href="/listings?category=mountains" class="btn btn-outline-secondary btn-sm px-3 py-1 fw-semibold shadow-sm border-0">⛰️ Mountains</a>
            <a href="/listings?category=castles" class="btn btn-outline-warning btn-sm px-3 py-1 fw-semibold shadow-sm border-0">🏰 Castles</a>
            <a href="/listings?category=amazing-pools" class="btn btn-outline-info btn-sm px-3 py-1 fw-semibold shadow-sm border-0">🏊 Amazing Pools</a>
            <a href="/listings?category=camping" class="btn btn-outline-success btn-sm px-3 py-1 fw-semibold shadow-sm border-0">🏕️ Camping</a>
            <a href="/listings?category=farms" class="btn btn-outline-success btn-sm px-3 py-1 fw-semibold shadow-sm border-0">🌾 Farms</a>
            <a href="/listings?category=arctic" class="btn btn-outline-primary btn-sm px-3 py-1 fw-semibold shadow-sm border-0">🧊 Arctic</a>
        </div>
        <div class="col-md-2 text-end">
            <div class="form-check-reverse form-switch">
                <input class="form-check-input" type="checkbox" id="viewToggle">
                <label class="form-check-label" for="viewToggle">Show GST</label>
            </div>
        </div>
    </div>
</div>



<div class="row row-cols-1 row-cols-md-2 row-cols-lg-3 g-4">
    <% listings.forEach(listing => { %>
        <div class="col">
            <div class="card h-100 shadow-sm">
                <% if (listing.image) { %>
                    <img src="<%= listing.image.url %>" class="card-img-top" alt="<%= listing.title %>">
                <% } else { %>
                    <img src="/images/placeholder.jpg" class="card-img-top" alt="Placeholder Image">
                <% } %>
                <div class="card-body">
                    <h5 class="card-title"><a href="/listings/<%= listing._id %>" class="text-decoration-none text-primary"><%= listing.title %></a></h5>
                    <p class="card-text fw-bold text-success">
                        ₹<%= listing.price %>
                        <span class="gst-label d-none text-muted" style="font-size: 0.85rem;" id="gst-label-<%= listing._id %>">+18% GST</span>
                    </p>
                </div>
            </div>
        </div>
    <% }) %>
 </div>
</div>

<script>
    const toggle = document.getElementById('viewToggle');
    toggle.addEventListener('change', () => {
        document.querySelectorAll('.gst-label').forEach(span => {
            span.classList.toggle('d-none');
        });
    });
</script>